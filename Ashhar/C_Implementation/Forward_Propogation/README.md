# CNN In C From Sratch (Pre Trained Weights)

The code here implements a CNN in C on the **Mnist Dataset**, this is essentially a bare-bone CNN architecture that **over-fits a single image** to train the weights for only one specific image. 

In this project we use the pretrained weights that we have generated from the Python code that is placed in the folder './Ashhar' . We simply forward propogate on the images that we have read and provide the predicted label against each predicted image.

## The Image.c and Image.h Files

The `Image.c` file is a part of the CNN In C project, focusing on Convolutional Neural Networks (CNNs). This file contains functions for reading images from a specified folder, processing them, and organizing the data into a structure called `Image`.

The `Image.h` file contains the datastructure that we will be using to store the images and its details such as the height and width and the target value of the image. 

### Functionality

#### `read_images_from_folder`

This function reads images from a given folder path, considering a specified number of images per class and a target value. It utilizes the STB image library to load image data and processes it to be suitable for further use. The processed image data is stored in the `Image` structure.

- **Parameters:**
  - `folder_path`: The path to the folder containing the images.
  - `per_class`: Number of images per class.
  - `target_value`: The target value (class) for the images being read.
  - `image`: An array of `struct Image` where the image data will be stored.
  - `i`: A pointer to the index for the `image` array.

#### `get_images`

This function orchestrates the process of getting images from different folders for each class. It specifies the paths for each class's folder and then calls the `read_images_from_folder` function for each class to read and process the images.

- **Parameters:**
  - `per_num`: Total number of images.
  - `image`: An array of `struct Image` where the image data will be stored.

## The Matrix.c and Matrix.h file

The `matrix.c` file is a part of the CNN In C project, focusing on Convolutional Neural Networks (CNNs). This file contains functions for initializing matrices, performing operations like addition and multiplication on matrices, and freeing allocated memory.

### Functions

#### `Matrix_Init`

This function initializes a matrix with the specified number of rows and columns. It allocates memory for the matrix elements.

- **Parameters:**
  - `x`: Pointer to the matrix structure.
  - `r`: Number of rows in the matrix.
  - `c`: Number of columns in the matrix.

#### `Num_Zeros`

This function sets all elements of a matrix to zero.

- **Parameters:**
  - `x`: Pointer to the matrix structure.
  - `r`: Number of rows in the matrix.
  - `c`: Number of columns in the matrix.

#### `print_matrix`

This function prints the elements of a matrix.

- **Parameters:**
  - `x`: Pointer to the matrix structure.
  - `r`: Number of rows in the matrix.
  - `c`: Number of columns in the matrix.

#### `free_matrix`

This function frees the memory allocated for a matrix.

- **Parameters:**
  - `x`: Pointer to the matrix structure.

#### `add_matrices`

This function adds two matrices element-wise and returns the result.

- **Parameters:**
  - `matrix1`: Pointer to the first matrix structure.
  - `matrix2`: Pointer to the second matrix structure.

- **Returns:**
  - `result`: A new matrix containing the sum of `matrix1` and `matrix2`.

#### `multiply_matrices`

This function multiplies two matrices and returns the result.

- **Parameters:**
  - `matrix1`: Pointer to the first matrix structure.
  - `matrix2`: Pointer to the second matrix structure.

- **Returns:**
  - `result`: A new matrix containing the product of `matrix1` and `matrix2`.

## The Main.c file

### Functions for Image Processing
    1) shuffle_images()
        - This function is used to shuffle the images in the image array because we have read images in a sequential format. This can be used to help facilitate the training of the neural network.

### Functions for The Convolution Layer

    1) filter_init()
    
        - This function takes a filter of size 3x3 and initializes it using random numbers ranging from 0-10
    
    2) convolution_forward()
    
        - This function performs the forward propogation for the convolutional layer, it takes an Image object
        that contains the pixels for the input image and uses the filter to iterate over the image.

        - It update the global variable named "conv_output" that will contain the feature map.

### Functions for the Max-Pooling Layer

    1) maxpool_forward()
    
        - This function performs the forward propogation for the maxpooling layer.
    
        - It takes the feature map that was generated by the concolutional layer and uses a filter
          of size 2x2 with a stride of 2 to generate a reduced feature map.
    
        - The reduced feature map is stored in the global variable named "maxpool_output" 

### Functions for the Dense Layer
  
      1) dense_weight_init()
  
          - This function will initialize the dense layer vector for classification
            of the input image and apply the softmax activation function to it.
  
      2) dense_forward()
  
          - This function will implement the forward propogation for the dense layer.
          
          - First it will take the reduced feature map and flatten it into a 1D array which can be used 
          for vector multiplication.
  
          - After we have flattened the reduced feature map, we will use the equation z = x(t) * w to get
          the logits which represent the score for a class.
  
          - When we have the logits, we will apply the softmax activation function to retrieve the probality
          vector which we will use to make our prediction.

