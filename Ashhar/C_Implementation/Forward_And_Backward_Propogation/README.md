## CNN In C From Scratch (With Training)

The code here implements a CNN in C on the **Mnist Dataset**, this is essentially a bare-bone CNN architecture that **over-fits a single image** to train the weights for only one specific image.

## The Image.c and Image.h Files

The `Image.c` file is a part of the CNN In C project, focusing on Convolutional Neural Networks (CNNs). This file contains functions for reading images from a specified folder, processing them, and organizing the data into a structure called `Image`.

The `Image.h` file contains the datastructure that we will be using to store the images and its details such as the height and width and the target value of the image. 

### Functionality

#### `read_images_from_folder`

This function reads images from a given folder path, considering a specified number of images per class and a target value. It utilizes the STB image library to load image data and processes it to be suitable for further use. The processed image data is stored in the `Image` structure.

- **Parameters:**
  - `folder_path`: The path to the folder containing the images.
  - `per_class`: Number of images per class.
  - `target_value`: The target value (class) for the images being read.
  - `image`: An array of `struct Image` where the image data will be stored.
  - `i`: A pointer to the index for the `image` array.

#### `get_images`

This function orchestrates the process of getting images from different folders for each class. It specifies the paths for each class's folder and then calls the `read_images_from_folder` function for each class to read and process the images.

- **Parameters:**
  - `per_num`: Total number of images.
  - `image`: An array of `struct Image` where the image data will be stored.

## The Matrix.c and Matrix.h file

The `matrix.c` file is a part of the CNN In C project, focusing on Convolutional Neural Networks (CNNs). This file contains functions for initializing matrices, performing operations like addition and multiplication on matrices, and freeing allocated memory.

### Functions

#### `Matrix_Init`

This function initializes a matrix with the specified number of rows and columns. It allocates memory for the matrix elements.

- **Parameters:**
  - `x`: Pointer to the matrix structure.
  - `r`: Number of rows in the matrix.
  - `c`: Number of columns in the matrix.

#### `Num_Zeros`

This function sets all elements of a matrix to zero.

- **Parameters:**
  - `x`: Pointer to the matrix structure.
  - `r`: Number of rows in the matrix.
  - `c`: Number of columns in the matrix.

#### `print_matrix`

This function prints the elements of a matrix.

- **Parameters:**
  - `x`: Pointer to the matrix structure.
  - `r`: Number of rows in the matrix.
  - `c`: Number of columns in the matrix.

#### `free_matrix`

This function frees the memory allocated for a matrix.

- **Parameters:**
  - `x`: Pointer to the matrix structure.

#### `add_matrices`

This function adds two matrices element-wise and returns the result.

- **Parameters:**
  - `matrix1`: Pointer to the first matrix structure.
  - `matrix2`: Pointer to the second matrix structure.

- **Returns:**
  - `result`: A new matrix containing the sum of `matrix1` and `matrix2`.

#### `multiply_matrices`

This function multiplies two matrices and returns the result.

- **Parameters:**
  - `matrix1`: Pointer to the first matrix structure.
  - `matrix2`: Pointer to the second matrix structure.

- **Returns:**
  - `result`: A new matrix containing the product of `matrix1` and `matrix2`.

## The Main.c file

### Functions for The Convolution Layer

#### `filter_init`

- This function takes a filter of size 3x3 and initializes it using random numbers ranging from 0-10.

#### `convolution_forward`

- This function performs the forward propagation for the convolutional layer.
  
- Parameters:
  - `Image object`: Contains the pixels for the input image.
  
- Updates the global variable named "conv_output" that will contain the feature map.

#### `convolution_backward`

- This function performs the backpropagation for the convolution layer.
  
- Parameters:
  - `Image object`: The input image on which forward propagation was applied.
  - `alpha`: Learning rate.

- Retrieves patches used in forward propagation, multiplies patches with their respective errors to generate a 3x3 matrix, and adds them for the total error for the weights.
  
- Updates the weights of the kernel.

### Functions for the Max-Pooling Layer

#### `maxpool_forward`

- This function performs the forward propagation for the max-pooling layer.
  
- Takes the feature map generated by the convolutional layer and uses a filter of size 2x2 with a stride of 2 to generate a reduced feature map.
  
- The reduced feature map is stored in the global variable named "maxpool_output".

#### `maxpool_backward`

- This function performs the backpropagation for the max-pooling layer.
  
- Creates a 1D vector `grad_copy` of size 49 representing the values of the gradient sent from a dense layer of size 7x7.
  
- Performs the pooling operation to find the indexes that contained those max values in the 14x14 array.

- Inserts the corresponding error value in that specific index, forming a 14x14 matrix to be sent to the convolution layer for backpropagation.

### Functions for the Dense Layer
  
#### `dense_weight_init`

- This function initializes the dense layer vector for the classification of the input image and applies the softmax activation function to it.

#### `dense_forward`

- This function implements the forward propagation for the dense layer.
  
- Flattens the reduced feature map into a 1D array.
  
- Computes logits using the equation z = x(t) * w.

- Applies the softmax activation function to retrieve the probability vector used for prediction.

#### `dense_backward`

- This function implements the backpropagation for the dense layer.
  
- Uses a 1D matrix of size 10 containing gradients of the cross-entropy loss.
  
- Multiplies/dot-products the gradients with the softmax derivative vector (dY_dZ) to produce a vector dE_dZ of size 10.
  
- Uses dE_dZ to find the values dE_dw, updating the 49x10 weight matrix of the dense layer.
  
- Finds the error dE_dX using the weight matrix dZ_dW and the dE_dZ vector, sending it backward to the max-pooling layer.

